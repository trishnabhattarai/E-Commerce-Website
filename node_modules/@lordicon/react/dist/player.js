import{jsx as t}from"react/jsx-runtime";import{isNil as e}from"@lordicon/helpers";import s from"lottie-web";import i from"react";const o={renderer:"svg",loop:!1,autoplay:!1,rendererSettings:{preserveAspectRatio:"xMidYMid meet",progressiveLoad:!0,hideOnTransparent:!0}},n="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,r="\n    :host {\n        position: relative;\n        display: block;\n        transform: translate3d(0px, 0px, 0px);\n        width: 100%;\n        aspect-ratio: 1/1;\n        overflow: hidden;\n    }\n\n    :host(.colorize) svg path[fill] {\n        fill: currentColor;\n    }\n\n    :host(.colorize) svg path[stroke] {\n        stroke: currentColor;\n    }\n\n    svg {\n        position: absolute;\n        pointer-events: none;\n        display: block;\n        transform: unset!important;\n    }\n\n    ::slotted(*) {\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n    }\n\n    .body.ready ::slotted(*) {\n        display: none;\n    }\n";let a;class h extends i.Component{_ref;_states=[];_state;_root;_lottie;constructor(t){super(t),this._ref=i.createRef()}connect(){if(!this.props.icon)return;if(this._states=(this.props.icon.markers||[]).map((t=>{const[s,i]=t.cm.split(":"),o={time:t.tm,duration:t.dr,name:i||s,default:!(!i||!s.includes("default"))};return(o.name===this.props.state||o.default&&e(this.props.state))&&(this._state=o),o})),this._states.length){const t=this._states[0],e=this._states[this._states.length-1];this.props.icon.ip=t.time,this.props.icon.op=e.time+e.duration+1}const t=this._root.lastElementChild,i={};this._state&&(i.initialSegment=[this._state.time,this._state.time+this._state.duration+1]),this._lottie=s.loadAnimation({container:t,animationData:this.props.icon,...i,...o}),this._lottie.setDirection(this.props.direction||1),this._lottie.addEventListener("complete",(t=>{this.onFinish()})),this._lottie.isLoaded?this.onReady():this._lottie.addEventListener("config_ready",(()=>{this.onReady()}))}disconnect(){this._lottie&&(this._lottie.destroy(),this._lottie=void 0)}componentDidMount(){if(!this._root){if(this._root=this._ref?.current.attachShadow({mode:"open"}),n)a||(a=new CSSStyleSheet,a.replaceSync(r)),this._root.adoptedStyleSheets=[a];else{const t=document.createElement("style");t.innerHTML=r,this._root.appendChild(t)}const t=document.createElement("div");t.classList.add("body"),this._root.appendChild(t)}this.connect()}componentWillUnmount(){this.disconnect()}componentDidUpdate(t,e){t.state!==this.props.state&&this.onStateChanged(),t.direction!==this.props.direction&&this.onDirectionChanged(),t.icon!==this.props.icon&&this.onIconChanged()}onFinish(){this.props.onComplete?.()}onDirectionChanged(){this._lottie.setDirection(this.props.direction)}onStateChanged(){const t=this.isPlaying;this._state=void 0,e(this.props.state)?this._state=this._states.filter((t=>t.default))[0]:this.props.state&&(this._state=this._states.filter((t=>t.name===this.props.state))[0]),this._state?this._lottie?.setSegment(this._state.time,this._state.time+this._state.duration+1):this._lottie.resetSegments(!0),this.goToFirstFrame(),t&&(this.pause(),this.play())}onIconChanged(){this.disconnect(),this.connect()}onReady(){this.props.onReady?.()}play(){this._lottie.play()}playFromBeginning(){if(this._state){const t=[this._state.time,this._state.time+this._state.duration+1];this._lottie.playSegments(t,!0)}else this._lottie.goToAndPlay(0)}pause(){this._lottie.pause()}goToFirstFrame(){this.goToFrame(0)}goToLastFrame(){this.goToFrame(Math.max(0,this.frames))}goToFrame(t){this._lottie.goToAndStop(t,!0)}refresh(){this._lottie?.renderer.renderFrame(null)}render(){const e=this.props.size||32,s=this.props.colorize||void 0;return t("div",{ref:this._ref,className:this.props.colorize?"colorize":void 0,style:{width:e,height:e,color:s,aspectRatio:1,flexDirection:"row"}})}get frames(){return this._lottie.getDuration(!0)-1}get isPlaying(){return!this._lottie.isPaused}get states(){return this._states}get currentState(){return this._state}}export{h as Player};
//# sourceMappingURL=player.js.map
